<!-- DEBUG SCRIPT: ‡πÄ‡∏ä‡πá‡∏Ñ Staff Access -->
<!-- ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ: ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÅ‡∏ó‡∏ô staff-panel.html ‡πÅ‡∏•‡πâ‡∏ß‡∏î‡∏π‡∏ú‡∏•‡πÉ‡∏ô Console -->

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Staff Access - PRIJIT SPORT</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #252526;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.5);
        }
        h1 {
            color: #4ec9b0;
            border-bottom: 2px solid #4ec9b0;
            padding-bottom: 10px;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 5px;
            font-size: 14px;
        }
        .loading { background: #264f78; color: #9cdcfe; }
        .success { background: #0e6300; color: #4ec9b0; }
        .error { background: #5a1d1d; color: #f48771; }
        .info { background: #373737; color: #dcdcaa; }
        .code {
            background: #1e1e1e;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            overflow-x: auto;
        }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        button:hover { background: #1177bb; }
        .copy-btn {
            background: #2ea043;
            font-size: 12px;
            padding: 5px 10px;
        }
        .copy-btn:hover { background: #3fb950; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Debug Staff Access</h1>
        <p>‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏ó‡∏≥‡πÑ‡∏° Staff Panel ‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ</p>
        
        <div id="status" class="status loading">
            ‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î Firebase...
        </div>
        
        <div id="results"></div>
        
        <div id="actions" style="display: none;">
            <h3>üõ†Ô∏è ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:</h3>
            <button onclick="copyUID()">üìã Copy UID</button>
            <button onclick="checkRules()">üîí ‡πÄ‡∏ä‡πá‡∏Ñ Firebase Rules</button>
            <button onclick="window.location.reload()">üîÑ Refresh</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // Firebase Config
        const firebaseConfig = {
            apiKey: "AIzaSyB6jVc8qcyS9zIJvfi-E1BL7BaxrUorO7w",
            authDomain: "prijit-sport.firebaseapp.com",
            databaseURL: "https://prijit-sport-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "prijit-sport",
            storageBucket: "prijit-sport.firebasestorage.app",
            messagingSenderId: "19782245186",
            appId: "1:19782245186:web:8ff3e2e17a214edc3546db"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let currentUID = null;

        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }

        function addResult(title, content, type = 'info') {
            const resultsDiv = document.getElementById('results');
            resultsDiv.innerHTML += `
                <div class="status ${type}">
                    <strong>${title}</strong>
                    <div class="code">${content}</div>
                </div>
            `;
        }

        function copyUID() {
            if (currentUID) {
                navigator.clipboard.writeText(currentUID);
                alert('‚úÖ ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å UID ‡πÅ‡∏•‡πâ‡∏ß: ' + currentUID);
            }
        }

        function checkRules() {
            window.open('https://console.firebase.google.com/project/prijit-sport/database/prijit-sport-default-rtdb/rules', '_blank');
        }

        // Main debug function
        auth.onAuthStateChanged(async (user) => {
            const resultsDiv = document.getElementById('results');
            const actionsDiv = document.getElementById('actions');
            resultsDiv.innerHTML = '';

            if (!user) {
                updateStatus('‚ùå ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login', 'error');
                addResult('‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:', '‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ Login ‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö<br><br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤ Login ‡∏Å‡πà‡∏≠‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏°‡∏≤‡πÄ‡∏ä‡πá‡∏Ñ‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á', 'error');
                return;
            }

            updateStatus('‚úÖ Login ‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...', 'success');
            currentUID = user.uid;

            // Step 1: ‡πÅ‡∏™‡∏î‡∏á User Info
            addResult('1Ô∏è‚É£ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• User ‡∏ó‡∏µ‡πà Login:', `
                <strong>UID:</strong> ${user.uid}<br>
                <strong>Email:</strong> ${user.email || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}<br>
                <strong>Display Name:</strong> ${user.displayName || '‡πÑ‡∏°‡πà‡∏°‡∏µ'}
            `, 'info');

            console.log('='.repeat(50));
            console.log('DEBUG: Current User');
            console.log('UID:', user.uid);
            console.log('Email:', user.email);
            console.log('='.repeat(50));

            // Step 2: ‡πÄ‡∏ä‡πá‡∏Ñ‡πÉ‡∏ô staff node
            try {
                const staffSnapshot = await database.ref('staff/' + user.uid).once('value');
                
                if (staffSnapshot.exists()) {
                    const staffData = staffSnapshot.val();
                    addResult('2Ô∏è‚É£ ‡πÄ‡∏ä‡πá‡∏Ñ Staff Node:', `
                        ‚úÖ <strong>‡∏û‡∏ö UID ‡πÉ‡∏ô staff node!</strong><br><br>
                        <strong>Path:</strong> staff/${user.uid}<br>
                        <strong>Data:</strong><br>
                        ${JSON.stringify(staffData, null, 2).replace(/\n/g, '<br>').replace(/ /g, '&nbsp;')}
                    `, 'success');
                    
                    console.log('='.repeat(50));
                    console.log('DEBUG: Staff Node Data');
                    console.log('Path:', 'staff/' + user.uid);
                    console.log('Data:', staffData);
                    console.log('='.repeat(50));

                    // Step 3: ‡πÄ‡∏ä‡πá‡∏Ñ Role
                    if (staffData.role === 'staff') {
                        addResult('3Ô∏è‚É£ ‡πÄ‡∏ä‡πá‡∏Ñ Role:', `
                            ‚úÖ <strong>Role ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</strong><br>
                            Role: "${staffData.role}"
                        `, 'success');
                        
                        updateStatus('‚úÖ ‡∏ó‡∏∏‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á! ‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏ß‡∏£‡πÄ‡∏Ç‡πâ‡∏≤ Staff Panel ‡πÑ‡∏î‡πâ', 'success');
                        
                        addResult('üéâ ‡∏™‡∏£‡∏∏‡∏õ:', `
                            <strong>‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤ Staff Panel</strong><br><br>
                            ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ‡∏•‡∏≠‡∏á:<br>
                            1. Clear Cache (Ctrl+Shift+Delete)<br>
                            2. Logout ‡πÅ‡∏•‡πâ‡∏ß Login ‡πÉ‡∏´‡∏°‡πà<br>
                            3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Firebase Rules ‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á<br>
                            4. ‡∏£‡∏≠ 1-2 ‡∏ô‡∏≤‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á Publish Rules
                        `, 'success');

                    } else {
                        addResult('3Ô∏è‚É£ ‡πÄ‡∏ä‡πá‡∏Ñ Role:', `
                            ‚ùå <strong>Role ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á!</strong><br>
                            Role ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: "${staffData.role}"<br>
                            ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô: "staff"
                        `, 'error');
                        
                        updateStatus('‚ùå Role ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á', 'error');
                        
                        addResult('üõ†Ô∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:', `
                            ‡πÑ‡∏õ‡∏ó‡∏µ‡πà Firebase Database:<br>
                            Path: staff/${user.uid}/role<br>
                            ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô: "staff"
                        `, 'info');
                    }

                } else {
                    addResult('2Ô∏è‚É£ ‡πÄ‡∏ä‡πá‡∏Ñ Staff Node:', `
                        ‚ùå <strong>‡πÑ‡∏°‡πà‡∏û‡∏ö UID ‡πÉ‡∏ô staff node!</strong><br><br>
                        UID ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì: <code>${user.uid}</code><br><br>
                        UID ‡∏ô‡∏µ‡πâ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤ staff node
                    `, 'error');
                    
                    console.log('='.repeat(50));
                    console.log('DEBUG: Staff Node Not Found');
                    console.log('Checked Path:', 'staff/' + user.uid);
                    console.log('Result: Does not exist');
                    console.log('='.repeat(50));

                    updateStatus('‚ùå UID ‡πÑ‡∏°‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô staff node', 'error');
                    
                    addResult('üõ†Ô∏è ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç:', `
                        <strong>Step 1:</strong> Copy UID ‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô<br>
                        <button class="copy-btn" onclick="copyUID()">üìã Copy UID</button><br><br>
                        
                        <strong>Step 2:</strong> ‡πÄ‡∏õ‡∏¥‡∏î Firebase Console<br>
                        ‚Üí Realtime Database<br>
                        ‚Üí staff node<br><br>
                        
                        <strong>Step 3:</strong> ‡πÄ‡∏û‡∏¥‡πà‡∏° child ‡πÉ‡∏´‡∏°‡πà:<br>
                        <div class="code">
                        staff/<br>
                        &nbsp;&nbsp;‚îî‚îÄ‚îÄ ${user.uid}<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ fullname: "‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì"<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚îú‚îÄ‚îÄ email: "${user.email || 'email@example.com'}"<br>
                        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ role: "staff"
                        </div>
                    `, 'info');
                }

                // Step 4: ‡∏•‡∏¥‡∏™‡∏ï‡πå Staff ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                const allStaffSnapshot = await database.ref('staff').once('value');
                const allStaff = allStaffSnapshot.val();
                
                if (allStaff) {
                    const staffList = Object.keys(allStaff).map(uid => {
                        const staff = allStaff[uid];
                        const isCurrent = uid === user.uid;
                        return `${isCurrent ? 'üë§ ' : '  '}<strong>${uid}</strong>${isCurrent ? ' (‡∏Ñ‡∏∏‡∏ì)' : ''}<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;‚îî‚îÄ‚îÄ ${staff.fullname || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ä‡∏∑‡πà‡∏≠'} (${staff.role || '‡πÑ‡∏°‡πà‡∏°‡∏µ role'})`;
                    }).join('<br>');
                    
                    addResult('4Ô∏è‚É£ Staff ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:', staffList, 'info');
                    
                    console.log('='.repeat(50));
                    console.log('DEBUG: All Staff');
                    console.log(allStaff);
                    console.log('='.repeat(50));
                }

            } catch (error) {
                addResult('‚ùå Error:', `
                    <strong>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î:</strong><br>
                    ${error.message}<br><br>
                    <strong>‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡πÑ‡∏î‡πâ:</strong><br>
                    1. Firebase Rules ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á<br>
                    2. ‡πÑ‡∏°‡πà‡∏°‡∏µ Permission ‡∏≠‡πà‡∏≤‡∏ô staff node
                `, 'error');
                
                console.error('DEBUG Error:', error);
                updateStatus('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', 'error');
            }

            actionsDiv.style.display = 'block';
        });

        console.log('%cüîç Staff Access Debug Script', 'font-size: 20px; font-weight: bold; color: #4ec9b0;');
        console.log('%c‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏', 'font-size: 14px; color: #9cdcfe;');
    </script>
</body>
</html>